<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡§°‡§ø‡§ú‡§ø‡§ü‡§≤ ‡§µ‡§ø‡§ú‡§ø‡§ü‡§ø‡§Ç‡§ó ‡§ï‡§æ‡§∞‡•ç‡§°</title>
  <!-- PWA Manifest -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#007bff">
<style>
body { font-family: Arial, sans-serif; background:#f6f9fc; text-align:center; padding:20px; }
.card { background:#e9f7ff; border-radius:20px; box-shadow:0 6px 15px rgba(0,0,0,0.15); padding:25px; max-width:480px; margin:auto; border:3px solid #007bff; }
.header { display:flex; align-items:center; justify-content:center; gap:15px; }
.header img { width:110px; height:110px; border-radius:50%; object-fit:cover; border:2px solid #fff; box-shadow:0 2px 6px rgba(0,0,0,0.2);}
.header-text { text-align:left; display:flex; flex-direction:column; align-items:flex-start; }
.header-text h1 { margin:0; font-size:22px; color:#333; }
.header-text .tags { margin-top:6px; display:flex; gap:8px; font-weight:bold; }
.tags span.lic { color:#007bff; } .tags span.mf { color:#28a745; } .tags span.gi { color:#dc3545; }
.buy-container, .my-container { margin:20px auto; max-width:360px; }
.buy-container h3, .my-container h3 { margin-bottom:5px; font-size:16px; }
.arrow-down { display:block; font-size:20px; margin-bottom:8px; animation:bounce 1s infinite alternate; }
@keyframes bounce { from { transform:translateY(0);} to { transform:translateY(5px); } }
.buy-box, .my-box { border:2px solid #007bff; border-radius:12px; background:#d6f0ff; padding:15px; display:grid; grid-template-columns:1fr 1fr; gap:10px; }
.buy-box button, .my-box button, .recommend-btn { padding:12px; font-size:15px; border:none; border-radius:10px; color:white; cursor:pointer; }
.btn1{background:#007bff;} .btn2{background:#28a745;} .btn3{background:#17a2b8;} .btn4{background:#ffc107;color:black;} .btn5{background:#dc3545;} .btn6{background:#6f42c1;} .btn7{background:#20c997;} .btn8{background:#fd7e14;} .btn9{background:#6610f2;} .btn10{background:#e83e8c;}
.recommend-btn { background:#e83e8c; margin-top:15px; width:90%; }
.form-popup { display:none; position:fixed; top:50%; left:50%; transform:translate(-50%,-50%); background:white; padding:20px; border-radius:15px; box-shadow:0 5px 15px rgba(0,0,0,0.3); z-index:999; width:300px; }
.form-popup input, .form-popup select { width:100%; padding:8px; margin:8px 0; border-radius:5px; border:1px solid #ccc; }
.form-popup button { width:100%; padding:10px; background:green; color:white; border:none; border-radius:10px; }
@media(max-width:420px){ .header img{width:80px;height:80px;} .header-text h1{font-size:18px;} .tags span{font-size:12px;gap:6px;} .card{max-width:360px;padding:16px;} }
</style>
</head>
<body>

<div class="card">
  <!-- Header -->
 <div class="header">
  <img src="MyPhoto.jpg" alt="‡§Ü‡§™‡§ï‡§æ ‡§´‡•ã‡§ü‡•ã">
  <div class="header-text">
    <h1>RAMESH CHAND YADAV</h1>
    <div class="tags">
      <span class="lic">LIC|</span>
      <span class="mf">Mutual Funds|</span>
      <span class="gi">General Insurance</span>
    </div>
    <p style="margin:5px 0 0 0;font-size:14px;color:#333;line-height:1.6;">
      <a href="tel:9868920766" style="text-decoration:none;color:inherit;">üìû 9868920766</a>
      <a href="https://wa.me/7878787878" target="_blank" style="margin-left:6px;text-decoration:none;">
        <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg"
             alt="WhatsApp" style="height:18px;width:18px;vertical-align:middle;">
      </a><br>
      <a href="mailto:ram111.2008@rediffmail.com" style="text-decoration:none;color:inherit;">‚úâÔ∏è ram111.2008@rediffmail.com</a>
    </p>
    <a href="mycontact.vcf" download
       style="display:inline-block;margin-top:5px; padding:5px 10px;font-size:13px; background:#28a745;color:white; border-radius:6px;text-decoration:none;">
      Save Contact
    </a>
  </div>
</div>

<!-- Buy Buttons -->
<div class="buy-container">
  <h3>To Buy Click the button</h3>
  <span class="arrow-down">üëá</span>
  <div class="buy-box">
    <button class="btn1" onclick="openForm('LIC')">LIC</button>
    <button class="btn2" onclick="openForm('Mutual Funds')">Mutual Funds</button>
    <button class="btn3" onclick="openForm('Vehicle Insurance')">Vehicle Insurance</button>
    <button class="btn4" onclick="openForm('Health Insurance')">Health Insurance</button>
    <button class="btn5" onclick="openForm('Travel Insurance')">Travel Insurance</button>
    <button class="btn6" onclick="openForm('PA Policy')">PA Policy</button>
  </div>
</div>

<!-- To View Buttons -->
<div class="my-container">
  <h3>To View Click the button</h3>
  <span class="arrow-down">üëá</span>
  <div class="my-box">
    <button class="btn7" onclick="openPolicyPopup('LIC')">MY LIC POLICY</button>
    <button class="btn8" onclick="openPolicyPopup('Vehicle')">MY VEHICLE POLICY</button>
    <button class="btn9" onclick="openPolicyPopup('Health')">MY HEALTH POLICY</button>
    <button class="btn10" onclick="openMFForm()">MF FOLIOS</button>
  </div>
</div>

<!-- Recommend Button -->
<button class="recommend-btn" onclick="openRecommendForm()">Recommend and earn Rs. 200 to Rs.1000 on every lead</button>

<!-- Policy Popup (updated: includes 6-digit code, status, single-page check) -->
<div class="form-popup" id="policyPopup" data-policy-type="">
  <h3 id="policyTitle">‡§Ö‡§™‡§®‡§æ ‡§™‡•â‡§≤‡§ø‡§∏‡•Ä ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç</h3>

  <!-- 6-‡§Ö‡§Ç‡§ï‡•ã‡§Ç ‡§ï‡§æ ‡§ï‡•ã‡§°: ‡§Ø‡§π ‡§Ö‡§®‡§ø‡§µ‡§æ‡§∞‡•ç‡§Ø ‡§π‡•à (upload & view ‡§¶‡•ã‡§®‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è) -->
  <input type="text" id="policyCode" maxlength="6"
         placeholder="6 ‡§Ö‡§Ç‡§ï‡•ã‡§Ç ‡§ï‡§æ ‡§ï‡•ã‡§° ‡§°‡§æ‡§≤‡•á‡§Ç (‡§Ö‡§µ‡§∂‡•ç‡§Ø‡§ï)"
         style="width:100%;padding:8px;margin:8px 0;border-radius:6px;border:1px solid #ccc;">

  <!-- ‡§∏‡•ç‡§•‡§ø‡§§‡§ø/‡§∏‡•ç‡§ü‡•á‡§ü‡§∏ ‡§¶‡§ø‡§ñ‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è -->
  <div id="policyStatus" style="font-size:13px;color:#333;margin:6px 0; min-height:18px;"></div>

  <div id="policyRows">
    <div class="policy-row" style="display:flex; gap:10px; align-items:center; margin-bottom:5px;">
      <button class="upload-btn" style="background:red; color:white; flex:1;">UPLOAD PDF</button>
      <button class="view-btn" style="background:green; color:white; flex:1;" disabled>VIEW POLICY</button>
    </div>
    <button class="add-row" style="margin-top:5px; border:none; border-radius:50%; width:30px; height:30px; font-size:20px; cursor:pointer;">+</button>
  </div>
</div>


<!-- MF Form -->
<div class="form-popup" id="mfPopup">
  <h3>‡§ï‡•É‡§™‡§Ø‡§æ ‡§Æ‡•Å‡§ù‡•á ‡§Æ‡•á‡§∞‡•á Mutual Funds Folios ‡§¶‡•á‡§ñ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§™‡§®‡§æ App ‡§¶‡•á‡§®‡•á ‡§ï‡•Ä ‡§ï‡•É‡§™‡§æ ‡§ï‡§∞‡•á‡§Ç</h3>
  <form id="mfForm">
    <input type="hidden" name="formType" value="MF">
    <input type="text" name="name" placeholder="‡§Ü‡§™‡§ï‡§æ ‡§®‡§æ‡§Æ" required>
    <input type="email" name="email" placeholder="‡§à‡§Æ‡•á‡§≤" required>
    <input type="text" name="mobile" placeholder="‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Æ‡•ç‡§¨‡§∞" required>
    <select name="time" required>
      <option value="">‡§ï‡•â‡§≤ ‡§ï‡§∞‡§®‡•á ‡§ï‡§æ ‡§∏‡§π‡•Ä ‡§∏‡§Æ‡§Ø</option>
      <option>‡§∏‡•Å‡§¨‡§π</option>
      <option>‡§¶‡•ã‡§™‡§π‡§∞</option>
      <option>‡§∂‡§æ‡§Æ</option>
    </select>
    <button type="submit">‡§∏‡§¨‡§Æ‡§ø‡§ü</button>
  </form>
</div>

<!-- Recommend Form -->
<div class="form-popup" id="recommendPopup">
  <h3>Recommend & Earn Form</h3>
  <form id="recommendForm">
    <input type="hidden" name="formType" value="Recommend">
    <h4>‡§∞‡§ø‡§ï‡§Æ‡•á‡§Ç‡§° ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø</h4>
    <input type="text" name="recommended_name" placeholder="‡§®‡§æ‡§Æ" required>
    <input type="email" name="recommended_email" placeholder="‡§à‡§Æ‡•á‡§≤" required>
    <input type="text" name="recommended_mobile" placeholder="‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Æ‡•ç‡§¨‡§∞" required>
    <select name="interest" required>
      <option value="">‡§ï‡•ç‡§Ø‡§æ ‡§≤‡•á‡§®‡•á ‡§Æ‡•á‡§Ç ‡§∞‡•Å‡§ö‡§ø ‡§π‡•à?</option>
      <option value="LIC">LIC</option>
      <option value="MF">Mutual Funds</option>
      <option value="Health">Health Policy</option>
      <option value="Vehicle">Vehicle Policy</option>
    </select>
    <h4>‡§´‡•â‡§∞‡•ç‡§Æ ‡§≠‡§∞‡§®‡•á ‡§µ‡§æ‡§≤‡§æ</h4>
    <input type="text" name="your_name" placeholder="‡§Ü‡§™‡§ï‡§æ ‡§®‡§æ‡§Æ" required>
    <input type="email" name="your_email" placeholder="‡§à‡§Æ‡•á‡§≤" required>
    <input type="text" name="your_mobile" placeholder="‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Æ‡•ç‡§¨‡§∞" required>
    <button type="submit">‡§∏‡§¨‡§Æ‡§ø‡§ü</button>
  </form>
</div>

<script>
const GAS_URL = 'https://script.google.com/macros/s/AKfycbzxiyil6-PkUxaxVlpgawB7KROrlTdBVFKPPkrdMdwMUNqnFD-LxN0PAe8SWZqvwQS1hA/exec'; // ‡§Ü‡§™‡§ï‡§æ Apps Script URL (‡§Ø‡§¶‡§ø ‡§¨‡§¶‡§≤‡•á‡§Ç ‡§§‡•ã ‡§Ø‡§π‡§æ‡§Å ‡§Ö‡§™‡§°‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç)

/* ================= helper functions ================= */
function makeCloseButton(container, onClose){
  if(container.querySelector('.closeBtn')) return;
  let close = document.createElement('button');
  close.type = 'button';
  close.className = 'closeBtn';
  close.setAttribute('aria-label','Close');
  close.innerHTML = '‚úï';
  Object.assign(close.style, {
    position: 'absolute', top: '8px', right: '8px', width: '34px', height: '34px',
    borderRadius: '50%', border: 'none', background: '#f5f5f5', color: '#222', fontSize: '18px',
    cursor: 'pointer', boxShadow: '0 1px 4px rgba(0,0,0,0.25)', zIndex: 10001
  });
  close.addEventListener('click', function(e){
    e.stopPropagation();
    try { onClose(); } catch(err){ container.style.display = 'none'; }
  });
  container.appendChild(close);
}

function closeAllPopups(){
  document.querySelectorAll('.popup-overlay').forEach(o => o.remove());
  document.querySelectorAll('.form-popup').forEach(p => p.style.display = 'none');
}
document.addEventListener('keydown', function(e){ if(e.key === 'Escape') closeAllPopups(); });

/* ================= open simple forms (unchanged) ================= */
function openForm(service){
  const overlay = document.createElement('div');
  overlay.className = 'popup-overlay';
  Object.assign(overlay.style, { position:'fixed', top:0, left:0, width:'100%', height:'100%',
    background:'rgba(0,0,0,0.5)', display:'flex', justifyContent:'center', alignItems:'center', zIndex:9999 });

  const box = document.createElement('div');
  box.style.cssText = 'background:#fff;padding:20px;max-width:420px;width:94%;position:relative;border-radius:10px;box-shadow:0 6px 18px rgba(0,0,0,0.15);';
  box.innerHTML = `
    <h3 style="margin-top:0;font-size:18px;">${service} ‡§ï‡•á ‡§≤‡§ø‡§è ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§≠‡§∞‡•á‡§Ç</h3>
    <form class="tempForm" style="margin-top:8px;">
      <input type="hidden" name="formType" value="${service}">
      <input type="text" name="name" placeholder="‡§Ü‡§™‡§ï‡§æ ‡§®‡§æ‡§Æ" required style="width:100%;margin-bottom:8px;padding:8px;border-radius:6px;border:1px solid #ccc;">
      <input type="email" name="email" placeholder="‡§à‡§Æ‡•á‡§≤" required style="width:100%;margin-bottom:8px;padding:8px;border-radius:6px;border:1px solid #ccc;">
      <input type="text" name="mobile" placeholder="‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Æ‡•ç‡§¨‡§∞" required style="width:100%;margin-bottom:8px;padding:8px;border-radius:6px;border:1px solid #ccc;">
      <select name="time" required style="width:100%;margin-bottom:12px;padding:8px;border-radius:6px;border:1px solid #ccc;">
        <option value="">‡§ï‡•â‡§≤ ‡§ï‡§∞‡§®‡•á ‡§ï‡§æ ‡§∏‡§π‡•Ä ‡§∏‡§Æ‡§Ø</option>
        <option>‡§∏‡•Å‡§¨‡§π</option>
        <option>‡§¶‡•ã‡§™‡§π‡§∞</option>
        <option>‡§∂‡§æ‡§Æ</option>
      </select>
      <button type="submit" style="background:#007bff;color:#fff;padding:10px 14px;border:none;border-radius:8px;cursor:pointer;">‡§∏‡§¨‡§Æ‡§ø‡§ü</button>
    </form>
  `;
  overlay.appendChild(box); document.body.appendChild(overlay);
  makeCloseButton(box, ()=> overlay.remove());
  overlay.addEventListener('click', function(e){ if(e.target === overlay) overlay.remove(); });

  const form = box.querySelector('.tempForm');
  form.addEventListener('submit', function(e){
    e.preventDefault();
    const fd = new FormData(this);
    fd.append('formType', service);
    fetch(GAS_URL, { method:'POST', body: fd })
      .then(()=>{ alert('‡§Ü‡§™‡§ï‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§≠‡•á‡§ú ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à!'); overlay.remove(); })
      .catch(err=>{ console.error(err); alert('Error: '+err); });
  });
}

/* ================= Policy popup open ================= */
function openPolicyPopup(policyType){
  const popup = document.getElementById('policyPopup');
  if(!popup) return alert('Policy popup element ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ');
  popup.style.display = 'block';
  popup.style.position = 'fixed';
  popup.style.zIndex = 9999;
  // store policy type (used for upload/view)
  popup.dataset.policyType = policyType || '';
  document.getElementById('policyTitle').innerText = policyType || 'Policy';
  document.getElementById('policyStatus').innerText = '';
  makeCloseButton(popup, ()=> popup.style.display = 'none');
}

/* ================= Helper: status messages in popup ================= */
function showPolicyStatus(text){
  const s = document.getElementById('policyStatus');
  if(s) s.innerText = text;
}
function clearPolicyStatus(){
  const s = document.getElementById('policyStatus');
  if(s) s.innerText = '';
}

/* ================= policyRows handler (upload/view/add-row) ================= */
document.getElementById('policyRows').addEventListener('click', async function(e){
  let row = e.target.closest('.policy-row');
  const addBtn = e.target.closest('.add-row');

  if(!row && !addBtn) return;

  if(addBtn){
    // clone first row
    let firstRow = document.querySelector('.policy-row');
    let newRow = firstRow.cloneNode(true);
    newRow.querySelector('.view-btn').disabled = true;
    newRow.dataset.pdfurl = '';
    addBtn.before(newRow);
    return;
  }

  // UPLOAD action
  if(e.target.classList.contains('upload-btn')){
    const code = document.getElementById('policyCode').value.trim();
    if(code.length !== 6){ alert("‡§ï‡•É‡§™‡§Ø‡§æ 6 ‡§Ö‡§Ç‡§ï‡•ã‡§Ç ‡§ï‡§æ ‡§ï‡•ã‡§° ‡§°‡§æ‡§≤‡•á‡§Ç"); return; }

    // select file
    let fileInput = document.createElement('input');
    fileInput.type='file';
    fileInput.accept='application/pdf';
    fileInput.onchange = async ()=>{
      let file = fileInput.files[0];
       if (file.size > 5 * 1024 * 1024) {
    alert("‡§ï‡•É‡§™‡§Ø‡§æ 5 MB ‡§∏‡•á ‡§õ‡•ã‡§ü‡•Ä PDF ‡§π‡•Ä ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç‡•§ ‡§Ü‡§™‡§ï‡•Ä ‡§´‡§º‡§æ‡§á‡§≤ ‡§ï‡§æ ‡§Ü‡§ï‡§æ‡§∞: " + (file.size / (1024*1024)).toFixed(2) + " MB");
    return;
  }

      // --- check single-page quickly (heuristic) ---
      try{
       const arrayBuffer = await file.arrayBuffer();
const text = new TextDecoder('latin1').decode(arrayBuffer);
const pageMatches = (text.match(/\/Type\s*\/Page/g) || []).length;
if (pageMatches > 3) {
  alert("‡§ï‡•É‡§™‡§Ø‡§æ ‡§Ö‡§ß‡§ø‡§ï‡§§‡§Æ 3 ‡§™‡•á‡§ú ‡§§‡§ï ‡§ï‡•Ä PDF ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç‡•§ ‡§Ü‡§™‡§ï‡•Ä ‡§´‡§º‡§æ‡§á‡§≤ ‡§Æ‡•á‡§Ç " + pageMatches + " ‡§™‡•á‡§ú ‡§¶‡§ø‡§ñ‡•á‡•§");
  return;
}

          } catch(err){
        console.warn("Page check failed:", err);
        // continue but warn
      }

      // read as dataURL (base64)
      showPolicyStatus("Please wait... PDF is being uploaded");
      const dataUrl = await new Promise((res, rej) => {
        const fr = new FileReader();
        fr.onload = () => res(fr.result);
        fr.onerror = rej;
        fr.readAsDataURL(file);
      });
      const base64 = dataUrl.split(',')[1];

      // prepare payload
      const popup = document.getElementById('policyPopup');
      const policyType = popup.dataset.policyType || document.getElementById('policyTitle').innerText || '';
      const payload = {
        action: 'uploadPdf',
        filename: file.name,
        base64: base64,
        code: code,
        policyType: policyType
      };

      try{
        const resp = await fetch(GAS_URL, {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify(payload)
        });
        const jd = await resp.json();
        clearPolicyStatus();
        if(jd && jd.result === 'success' && jd.fileUrl){
          row.dataset.pdfurl = jd.fileUrl;
          row.querySelector('.view-btn').disabled = false;
          alert('PDF ‡§≠‡•á‡§ú ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à');
        } else {
          alert('Upload failed: server error');
          console.error('Upload resp', jd);
        }
      } catch(err){
        clearPolicyStatus();
        console.error(err);
        alert('Upload failed: '+err);
      }
    };
    fileInput.click();
  }

  // VIEW action
  if(e.target.classList.contains('view-btn')){
    const code = document.getElementById('policyCode').value.trim();
    if(code.length !== 6){ alert("‡§ï‡•É‡§™‡§Ø‡§æ 6 ‡§Ö‡§Ç‡§ï‡•ã‡§Ç ‡§ï‡§æ ‡§ï‡•ã‡§° ‡§°‡§æ‡§≤‡•á‡§Ç"); return; }
    showPolicyStatus("Please wait ‚Äî fetching policy...");
    const popup = document.getElementById('policyPopup');
    const policyType = popup.dataset.policyType || document.getElementById('policyTitle').innerText || '';

    try{
      const resp = await fetch(GAS_URL + '?action=getPdf&code=' + encodeURIComponent(code) + '&policyType=' + encodeURIComponent(policyType));
      const jd = await resp.json();
      clearPolicyStatus();
      if(jd && jd.fileUrl){
        window.open(jd.fileUrl, '_blank');
      } else {
        alert('‡§á‡§∏ ‡§ï‡•ã‡§° ‡§∏‡•á ‡§ï‡•ã‡§à PDF ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡•Ä‡•§');
      }
    } catch(err){
      clearPolicyStatus();
      console.error(err);
      alert('Error fetching policy: '+err);
    }
  }
});

/* ================= MF & Recommend forms (as before) ================= */
function openMFForm(){
  const popup = document.getElementById('mfPopup');
  if(!popup) return alert('MF popup element ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ');
  popup.style.display = 'block';
  popup.style.position = 'fixed';
  popup.style.zIndex = 9999;
  makeCloseButton(popup, ()=> popup.style.display='none');
}
document.getElementById('mfForm').addEventListener('submit', function(e){
  e.preventDefault();
  let fd = new FormData(this);
  fd.append('formType','MF');
  fetch(GAS_URL,{method:'POST',body:fd})
    .then(()=>{ alert('‡§Ü‡§™‡§ï‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§≠‡•á‡§ú ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à!'); this.reset(); document.getElementById('mfPopup').style.display='none'; })
    .catch(err=>{ console.error(err); alert('Error: '+err); });
});

function openRecommendForm(){
  const popup = document.getElementById('recommendPopup');
  if(!popup) return alert('Recommend popup element ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ');
  popup.style.display = 'block';
  popup.style.position = 'fixed';
  popup.style.zIndex = 9999;
  makeCloseButton(popup, ()=> popup.style.display='none');
}
document.getElementById('recommendForm').addEventListener('submit', function(e){
  e.preventDefault();
  let fd = new FormData(this);
  fd.append('formType','Recommend');
  fetch(GAS_URL,{method:'POST',body:fd})
    .then(()=>{ alert('‡§Ü‡§™‡§ï‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§≠‡•á‡§ú ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à!'); this.reset(); document.getElementById('recommendPopup').style.display='none'; })
    .catch(err=>{ console.error(err); alert('Error: '+err); });
});

/* ================= On DOM ready: ensure close buttons exist ================= */
document.addEventListener('DOMContentLoaded', function(){
  ['policyPopup','mfPopup','recommendPopup'].forEach(id=>{
    const el = document.getElementById(id);
    if(el){
      if(getComputedStyle(el).position === 'static') el.style.position = 'fixed';
      makeCloseButton(el, ()=> el.style.display = 'none');
    }
  });
});
</script>

</body>
</html>







