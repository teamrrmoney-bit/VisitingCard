<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>‡§°‡§ø‡§ú‡§ø‡§ü‡§≤ ‡§µ‡§ø‡§ú‡§ø‡§ü‡§ø‡§Ç‡§ó ‡§ï‡§æ‡§∞‡•ç‡§°</title>
<meta name="theme-color" content="#007bff" />
<style>
  body { font-family: Arial, sans-serif; background:#f6f9fc; text-align:center; padding:20px; }
  .card { background:#e9f7ff; border-radius:20px; box-shadow:0 6px 15px rgba(0,0,0,0.15); padding:25px; max-width:480px; margin:auto; border:3px solid #007bff; }
  .header { display:flex; align-items:center; justify-content:center; gap:15px; flex-wrap:wrap; }
  .header img { width:110px; height:110px; border-radius:50%; object-fit:cover; border:2px solid #fff; box-shadow:0 2px 6px rgba(0,0,0,0.2); }
  .header-text { text-align:left; display:flex; flex-direction:column; align-items:flex-start; min-width:200px; }
  .header-text h1 { margin:0; font-size:22px; color:#333; }
  .tags { margin-top:6px; display:flex; gap:8px; font-weight:bold; flex-wrap:wrap; }
  .tags span.lic{ color:#007bff } .tags span.mf{ color:#28a745 } .tags span.gi{ color:#dc3545 }
  .buy-container, .my-container { margin:20px auto; max-width:360px; }
  .arrow-down { display:block; font-size:20px; margin-bottom:8px; animation:bounce 1s infinite alternate; }
  @keyframes bounce { from { transform:translateY(0);} to { transform:translateY(5px); } }
  .buy-box, .my-box { border:2px solid #007bff; border-radius:12px; background:#d6f0ff; padding:15px; display:grid; grid-template-columns:1fr 1fr; gap:10px; }
  .buy-box button, .my-box button, .recommend-btn { padding:12px; font-size:15px; border:none; border-radius:10px; color:white; cursor:pointer; }
  .btn1{background:#007bff;} .btn2{background:#28a745;} .btn3{background:#17a2b8;} .btn4{background:#ffc107;color:black;} .btn5{background:#dc3545;} .btn6{background:#6f42c1;} .btn7{background:#20c997;} .btn8{background:#fd7e14;} .btn9{background:#6610f2;} .btn10{background:#e83e8c;}
  .recommend-btn { background:#e83e8c; margin-top:15px; width:90%; }

  /* Popup styles (mobile-friendly) */
  .popup-overlay { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.45); display:flex; justify-content:center; align-items:center; z-index:9998; }
  .form-popup { display:none; position:fixed; top:50%; left:50%; transform:translate(-50%,-50%); background:white; padding:18px; border-radius:14px; box-shadow:0 6px 20px rgba(0,0,0,0.25); z-index:9999; width:92%; max-width:420px; max-height:90vh; overflow:auto; }
  .form-popup h3{ margin-top:0; font-size:18px; }
  .form-popup .row { display:flex; gap:8px; align-items:center; margin-bottom:8px; }
  .form-popup input, .form-popup select { width:100%; padding:8px; margin:8px 0; border-radius:6px; border:1px solid #ccc; box-sizing:border-box; }
  .form-popup button { padding:10px; border-radius:8px; border:none; cursor:pointer; }
  .closeBtn { position:absolute; top:10px; right:10px; width:36px; height:36px; border-radius:50%; border:none; background:#f5f5f5; color:#222; font-size:18px; cursor:pointer; box-shadow:0 1px 4px rgba(0,0,0,0.2); z-index:10001; }
  #policyStatus{ font-size:13px; color:#333; min-height:18px; margin-bottom:6px; text-align:left; }

  @media(max-width:420px){
    .header img{width:80px;height:80px;}
    .header-text h1{font-size:18px;}
    .card{max-width:360px;padding:16px;}
  }
</style>
</head>
<body>

<div class="card">
  <div class="header">
    <img src="MyPhoto.jpg" alt="‡§Ü‡§™‡§ï‡§æ ‡§´‡•ã‡§ü‡•ã">
    <div class="header-text">
      <h1>RAMESH CHAND YADAV</h1>
      <div class="tags">
        <span class="lic">LIC|</span>
        <span class="mf">Mutual Funds|</span>
        <span class="gi">General Insurance</span>
      </div>
      <p style="margin:5px 0 0 0;font-size:14px;color:#333;line-height:1.6;">
        <a href="tel:9868920766" style="text-decoration:none;color:inherit;">üìû 9868920766</a>
        <a href="https://wa.me/7878787878" target="_blank" style="margin-left:6px;text-decoration:none;">
          <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" alt="WhatsApp" style="height:18px;width:18px;vertical-align:middle;">
        </a><br>
        <a href="mailto:ram111.2008@rediffmail.com" style="text-decoration:none;color:inherit;">‚úâÔ∏è ram111.2008@rediffmail.com</a>
      </p>
      <a href="mycontact.vcf" download style="display:inline-block;margin-top:5px; padding:5px 10px;font-size:13px; background:#28a745;color:white; border-radius:6px;text-decoration:none;">Save Contact</a>
    </div>
  </div>

  <div class="buy-container">
    <h3>To Buy Click the button</h3>
    <span class="arrow-down">üëá</span>
    <div class="buy-box">
      <button class="btn1" onclick="openForm('LIC')">LIC</button>
      <button class="btn2" onclick="openForm('Mutual Funds')">Mutual Funds</button>
      <button class="btn3" onclick="openForm('Vehicle Insurance')">Vehicle Insurance</button>
      <button class="btn4" onclick="openForm('Health Insurance')">Health Insurance</button>
      <button class="btn5" onclick="openForm('Travel Insurance')">Travel Insurance</button>
      <button class="btn6" onclick="openForm('PA Policy')">PA Policy</button>
    </div>
  </div>

  <div class="my-container">
    <h3>To View Click the button</h3>
    <span class="arrow-down">üëá</span>
    <div class="my-box">
      <button class="btn7" onclick="openPolicyPopup('LIC')">MY LIC POLICY</button>
      <button class="btn8" onclick="openPolicyPopup('Vehicle')">MY VEHICLE POLICY</button>
      <button class="btn9" onclick="openPolicyPopup('Health')">MY HEALTH POLICY</button>
      <button class="btn10" onclick="openMFForm()">MF FOLIOS</button>
    </div>
  </div>

  <button class="recommend-btn" onclick="openRecommendForm()">Recommend and earn Rs. 200 to Rs.1000 on every lead</button>
</div>

<!-- Policy popup: includes 6-digit code input, status, upload & view buttons -->
<div class="form-popup" id="policyPopup" aria-hidden="true">
  <h3 id="policyTitle">‡§Ö‡§™‡§®‡§æ ‡§™‡•â‡§≤‡§ø‡§∏‡•Ä ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç</h3>

  <label for="policyCode" style="display:block;text-align:left;font-weight:600;">6 ‡§Ö‡§Ç‡§ï‡•ã‡§Ç ‡§ï‡§æ ‡§ï‡•ã‡§° (‡§Ö‡§®‡§ø‡§µ‡§æ‡§∞‡•ç‡§Ø)</label>
  <input id="policyCode" maxlength="6" placeholder="‡§â‡§¶‡§æ. 123456" inputmode="numeric" pattern="[0-9]*">

  <div id="policyStatus"></div>

  <div id="policyRows">
    <div class="policy-row" style="display:flex; gap:10px; align-items:center; margin-bottom:5px;">
      <button class="upload-btn" style="background:red; color:white; flex:1;">UPLOAD PDF</button>
      <button class="view-btn" style="background:green; color:white; flex:1;" disabled>VIEW POLICY</button>
    </div>
  </div>

  <button class="add-row" style="margin-top:10px; border:none; border-radius:50%; width:40px; height:40px; font-size:20px; cursor:pointer;">+</button>
</div>

<!-- MF popup -->
<div class="form-popup" id="mfPopup" aria-hidden="true">
  <h3>‡§ï‡•É‡§™‡§Ø‡§æ ‡§Æ‡•Å‡§ù‡•á ‡§Æ‡•á‡§∞‡•á Mutual Funds Folios ‡§¶‡•á‡§ñ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§™‡§®‡§æ App ‡§¶‡•á‡§®‡•á ‡§ï‡•Ä ‡§ï‡•É‡§™‡§æ ‡§ï‡§∞‡•á‡§Ç</h3>
  <form id="mfForm">
    <input type="hidden" name="formType" value="MF">
    <input type="text" name="name" placeholder="‡§Ü‡§™‡§ï‡§æ ‡§®‡§æ‡§Æ" required>
    <input type="email" name="email" placeholder="‡§à‡§Æ‡•á‡§≤" required>
    <input type="text" name="mobile" placeholder="‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Æ‡•ç‡§¨‡§∞" required>
    <select name="time" required>
      <option value="">‡§ï‡•â‡§≤ ‡§ï‡§∞‡§®‡•á ‡§ï‡§æ ‡§∏‡§π‡•Ä ‡§∏‡§Æ‡§Ø</option>
      <option>‡§∏‡•Å‡§¨‡§π</option><option>‡§¶‡•ã‡§™‡§π‡§∞</option><option>‡§∂‡§æ‡§Æ</option>
    </select>
    <button type="submit">‡§∏‡§¨‡§Æ‡§ø‡§ü</button>
  </form>
</div>

<!-- Recommend popup -->
<div class="form-popup" id="recommendPopup" aria-hidden="true">
  <h3>Recommend & Earn Form</h3>
  <form id="recommendForm">
    <input type="hidden" name="formType" value="Recommend">
    <h4>‡§∞‡§ø‡§ï‡§Æ‡•á‡§Ç‡§° ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø</h4>
    <input type="text" name="recommended_name" placeholder="‡§®‡§æ‡§Æ" required>
    <input type="email" name="recommended_email" placeholder="‡§à‡§Æ‡•á‡§≤" required>
    <input type="text" name="recommended_mobile" placeholder="‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Æ‡•ç‡§¨‡§∞" required>
    <select name="interest" required>
      <option value="">‡§ï‡•ç‡§Ø‡§æ ‡§≤‡•á‡§®‡•á ‡§Æ‡•á‡§Ç ‡§∞‡•Å‡§ö‡§ø ‡§π‡•à?</option>
      <option value="LIC">LIC</option><option value="MF">Mutual Funds</option><option value="Health">Health Policy</option><option value="Vehicle">Vehicle Policy</option>
    </select>
    <h4>‡§´‡•â‡§∞‡•ç‡§Æ ‡§≠‡§∞‡§®‡•á ‡§µ‡§æ‡§≤‡§æ</h4>
    <input type="text" name="your_name" placeholder="‡§Ü‡§™‡§ï‡§æ ‡§®‡§æ‡§Æ" required>
    <input type="email" name="your_email" placeholder="‡§à‡§Æ‡•á‡§≤" required>
    <input type="text" name="your_mobile" placeholder="‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Æ‡•ç‡§¨‡§∞" required>
    <button type="submit">‡§∏‡§¨‡§Æ‡§ø‡§ü</button>
  </form>
</div>

<script>
/* ============ CONFIG ============ */
/* Replace with your deployed Apps Script / Web App URL (it should be the /exec URL) */
const GAS_URL = 'https://script.google.com/macros/s/AKfycbze6GAf3nKpwQ01sJ8DZitZnNOv3w21srctp905LhJFXX_Q19bTHB11RNU8wKNobK9YPQ/exec';

/* ============ Helpers ============ */
function makeCloseButton(container, onClose){
  if(container.querySelector('.closeBtn')) return;
  let close = document.createElement('button');
  close.className = 'closeBtn';
  close.type = 'button';
  close.innerHTML = '‚úï';
  close.addEventListener('click', function(e){
    e.stopPropagation();
    try{ onClose(); } catch(err){ container.style.display='none'; }
  });
  container.appendChild(close);
}

function openOverlayWith(node){
  // create overlay
  const overlay = document.createElement('div');
  overlay.className = 'popup-overlay';
  overlay.appendChild(node);
  document.body.appendChild(overlay);
  return overlay;
}

function closeOverlay(overlay){
  if(!overlay) return;
  overlay.remove();
}

/* show status text inside policy popup */
function showPolicyStatus(text){
  const s = document.getElementById('policyStatus');
  if(s) s.innerText = text;
}
function clearPolicyStatus(){
  const s = document.getElementById('policyStatus');
  if(s) s.innerText = '';
}

/* center & make popup visible */
function showPopup(el){
  // ensure styles
  el.style.display = 'block';
  el.setAttribute('aria-hidden','false');
  // add close button if missing
  makeCloseButton(el, ()=> { closeAllPopups(); });
  // wrap in overlay if not already wrapped
  if(!document.body.querySelector('.popup-overlay') || document.body.querySelector('.popup-overlay').contains(el) === false){
    const overlay = openOverlayWith(el);
    overlay.addEventListener('click', function(evt){
      if(evt.target === overlay) closeAllPopups();
    });
  }
  // ensure scrollable & centered (CSS handles transform center)
}

/* hide all popups */
function closeAllPopups(){
  document.querySelectorAll('.popup-overlay').forEach(o=>o.remove());
  document.querySelectorAll('.form-popup').forEach(p=>{ p.style.display='none'; p.setAttribute('aria-hidden','true'); });
}

/* ESC closes */
document.addEventListener('keydown', function(e){ if(e.key === 'Escape') closeAllPopups(); });

/* ============ Forms & popups (unchanged behavior except PDF upload changed to base64 JSON) ============ */

/* open dynamic buy form */
function openForm(service){
  // create popup box (we will reuse openOverlayWith)
  const box = document.createElement('div');
  box.className = 'form-popup';
  box.style.maxWidth = '420px';
  box.innerHTML = `
    <h3>${service} ‡§ï‡•á ‡§≤‡§ø‡§è ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§≠‡§∞‡•á‡§Ç</h3>
    <form class="tempForm" style="margin-top:8px;">
      <input type="hidden" name="formType" value="${service}">
      <input type="text" name="name" placeholder="‡§Ü‡§™‡§ï‡§æ ‡§®‡§æ‡§Æ" required style="width:100%;margin-bottom:8px;padding:8px;border-radius:6px;border:1px solid #ccc;">
      <input type="email" name="email" placeholder="‡§à‡§Æ‡•á‡§≤" required style="width:100%;margin-bottom:8px;padding:8px;border-radius:6px;border:1px solid #ccc;">
      <input type="text" name="mobile" placeholder="‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Æ‡•ç‡§¨‡§∞" required style="width:100%;margin-bottom:8px;padding:8px;border-radius:6px;border:1px solid #ccc;">
      <select name="time" required style="width:100%;margin-bottom:12px;padding:8px;border-radius:6px;border:1px solid #ccc;">
        <option value="">‡§ï‡•â‡§≤ ‡§ï‡§∞‡§®‡•á ‡§ï‡§æ ‡§∏‡§π‡•Ä ‡§∏‡§Æ‡§Ø</option>
        <option>‡§∏‡•Å‡§¨‡§π</option><option>‡§¶‡•ã‡§™‡§π‡§∞</option><option>‡§∂‡§æ‡§Æ</option>
      </select>
      <button type="submit" style="background:#007bff;color:#fff;padding:10px 14px;border:none;border-radius:8px;cursor:pointer;">‡§∏‡§¨‡§Æ‡§ø‡§ü</button>
    </form>
  `;
  showPopup(box);
  makeCloseButton(box, ()=> closeAllPopups());
  const form = box.querySelector('.tempForm');
  form.addEventListener('submit', function(e){
    e.preventDefault();
    const fd = new FormData(this);
    fd.append('formType', service);
    fetch(GAS_URL, { method:'POST', body: fd })
      .then(()=>{ alert('‡§Ü‡§™‡§ï‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§≠‡•á‡§ú ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à!'); closeAllPopups(); })
      .catch(err=>{ console.error(err); alert('Error: '+err); });
  });
}

/* open policy popup (uses same element in DOM) */
function openPolicyPopup(policyType){
  const popup = document.getElementById('policyPopup');
  if(!popup) return alert('Policy popup element ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ');
  document.getElementById('policyTitle').innerText = policyType + ' Policy Upload';
  // store policyType in dataset for later
  popup.dataset.policyType = policyType;
  showPopup(popup);
}

/* ============ PDF Upload & View (base64 JSON) ============ */
document.getElementById('policyRows').addEventListener('click', async function(e){
  const row = e.target.closest('.policy-row');
  const addBtn = e.target.closest('.add-row');

  if(addBtn){
    // clone a new row and append
    const first = document.querySelector('.policy-row');
    if(!first) return;
    const newRow = first.cloneNode(true);
    newRow.querySelector('.view-btn').disabled = true;
    newRow.dataset.pdfurl = '';
    document.getElementById('policyRows').appendChild(newRow);
    return;
  }

  // UPLOAD
  if(e.target.classList.contains('upload-btn')){
    const codeInput = document.getElementById('policyCode');
    const codeVal = codeInput && codeInput.value.trim();
    if(!codeVal || codeVal.length !== 6 || !/^\d{6}$/.test(codeVal)){
      alert('‡§ï‡•É‡§™‡§Ø‡§æ 6 ‡§Ö‡§Ç‡§ï‡•ã‡§Ç ‡§ï‡§æ ‡§µ‡•à‡§ß ‡§ï‡•ã‡§° ‡§°‡§æ‡§≤‡•á‡§Ç‡•§ (‡§ï‡•á‡§µ‡§≤ ‡§Ö‡§Ç‡§ï)');
      return;
    }

    // select file
    const fileInput = document.createElement('input');
    fileInput.type = 'file';
    fileInput.accept = 'application/pdf';
    fileInput.onchange = async () => {
      const file = fileInput.files[0];
      if(!file) return;

      // client-side size check 5MB
      if(file.size > 5 * 1024 * 1024){
        alert('‡§ï‡•É‡§™‡§Ø‡§æ 5 MB ‡§∏‡•á ‡§õ‡•ã‡§ü‡•Ä PDF ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç‡•§ ‡§Ü‡§™‡§ï‡•Ä ‡§´‡§º‡§æ‡§á‡§≤: ' + (file.size/(1024*1024)).toFixed(2) + ' MB');
        return;
      }

      // page-count heuristic (client-side)
      try{
        const ab = await file.arrayBuffer();
        const text = new TextDecoder('latin1').decode(ab);
        const pages = (text.match(/\/Type\s*\/Page/g) || []).length;
        if(pages > 3){
          alert('‡§ï‡•É‡§™‡§Ø‡§æ ‡§Ö‡§ß‡§ø‡§ï‡§§‡§Æ 3 ‡§™‡•á‡§ú ‡§§‡§ï ‡§ï‡•Ä PDF ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç‡•§ ‡§Ü‡§™‡§ï‡•Ä ‡§´‡§æ‡§á‡§≤ ‡§Æ‡•á‡§Ç ' + pages + ' ‡§™‡•á‡§ú ‡§π‡•à‡§Ç‡•§');
          return;
        }
      }catch(err){
        console.warn('Page-check failed, continuing upload', err);
      }

      // read as base64
      showPolicyStatus('Please wait... PDF is being uploaded');
      try{
        const arrayBuffer = await file.arrayBuffer();
        const base64 = btoa(String.fromCharCode(...new Uint8Array(arrayBuffer)));

        const popup = document.getElementById('policyPopup');
        const policyType = popup.dataset.policyType || document.getElementById('policyTitle').innerText || '';

        const payload = {
          action: 'uploadPdf',
          filename: file.name,
          base64: base64,
          code: codeVal,
          policyType: policyType
        };

        const resp = await fetch(GAS_URL, {
          method: 'POST',
          headers: {'Content-Type':'application/json'},
          body: JSON.stringify(payload)
        });

        const jd = await resp.json();
        clearPolicyStatus();

        if(jd && jd.result === 'success' && jd.fileUrl){
          // enable view button and attach url to row
          const viewBtn = row.querySelector('.view-btn');
          if(viewBtn){
            viewBtn.disabled = false;
            row.dataset.pdfurl = jd.fileUrl;
          }
          alert('PDF ‡§≠‡•á‡§ú ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à');
        } else {
          console.error('Upload error', jd);
          alert('Upload failed: server error');
        }
      }catch(err){
        clearPolicyStatus();
        console.error(err);
        alert('Upload failed: ' + err);
      }
    };

    fileInput.click();
    return;
  }

  // VIEW
  if(e.target.classList.contains('view-btn')){
    const codeInput = document.getElementById('policyCode');
    const codeVal = codeInput && codeInput.value.trim();
    if(!codeVal || codeVal.length !== 6 || !/^\d{6}$/.test(codeVal)){
      alert('‡§ï‡•É‡§™‡§Ø‡§æ 6 ‡§Ö‡§Ç‡§ï‡•ã‡§Ç ‡§ï‡§æ ‡§µ‡•à‡§ß ‡§ï‡•ã‡§° ‡§°‡§æ‡§≤‡•á‡§Ç‡•§ (‡§ï‡•á‡§µ‡§≤ ‡§Ö‡§Ç‡§ï)');
      return;
    }

    const popup = document.getElementById('policyPopup');
    const policyType = popup.dataset.policyType || document.getElementById('policyTitle').innerText || '';

    try{
      showPolicyStatus('Please wait ‚Äî fetching policy...');
      const resp = await fetch(GAS_URL + '?action=getPdf&code=' + encodeURIComponent(codeVal) + '&policyType=' + encodeURIComponent(policyType));
      const jd = await resp.json();
      clearPolicyStatus();
      if(jd && jd.fileUrl){
        // Open in new tab
        // show message while browser opens
        showPolicyStatus('Please wait ‚Äî PDF is being opened...');
        window.open(jd.fileUrl, '_blank');
        showPolicyStatus('');
      } else {
        alert('‡§á‡§∏ ‡§ï‡•ã‡§° ‡§∏‡•á ‡§ï‡•ã‡§à PDF ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡•Ä‡•§');
      }
    }catch(err){
      clearPolicyStatus();
      console.error(err);
      alert('Error fetching policy: ' + err);
    }
    return;
  }

});

/* MF popup open */
function openMFForm(){
  const popup = document.getElementById('mfPopup');
  if(!popup) return alert('MF popup element ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ');
  showPopup(popup);
}

/* MF form submit */
document.getElementById('mfForm').addEventListener('submit', function(e){
  e.preventDefault();
  const fd = new FormData(this);
  fd.append('formType','MF');
  fetch(GAS_URL, { method:'POST', body: fd })
    .then(()=>{ alert('‡§Ü‡§™‡§ï‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§≠‡•á‡§ú ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à!'); closeAllPopups(); this.reset(); })
    .catch(err=>{ console.error(err); alert('Error: '+err); });
});

/* Recommend popup open */
function openRecommendForm(){
  const popup = document.getElementById('recommendPopup');
  if(!popup) return alert('Recommend popup element ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ');
  showPopup(popup);
}

/* Recommend submit */
document.getElementById('recommendForm').addEventListener('submit', function(e){
  e.preventDefault();
  const fd = new FormData(this);
  fd.append('formType','Recommend');
  fetch(GAS_URL, { method:'POST', body: fd })
    .then(()=>{ alert('‡§Ü‡§™‡§ï‡§æ ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§≠‡•á‡§ú ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à!'); closeAllPopups(); this.reset(); })
    .catch(err=>{ console.error(err); alert('Error: '+err); });
});

/* On DOM ready: ensure static popups have close button available */
document.addEventListener('DOMContentLoaded', function(){
  ['policyPopup','mfPopup','recommendPopup'].forEach(id=>{
    const el = document.getElementById(id);
    if(el){
      if(getComputedStyle(el).position === 'static') el.style.position = 'fixed';
      makeCloseButton(el, ()=> closeAllPopups());
    }
  });
});
</script>
</body>
</html>




